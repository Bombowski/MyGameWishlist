SELECT * FROM STORE;
SELECT * FROM USER;
SELECT * FROM REVIEW;
SELECT * FROM WISHLIST_GAME;
SELECT * FROM SECRET_VARIABLES;
SELECT * FROM STEAM_GAMES;
SELECT * FROM PRICE_TIMELINE ORDER BY TIME;
SELECT * FROM WISHLIST_GAME_PRICE_TIMELINE;

DELETE FROM PRICE_TIMELINE WHERE URL != '' AND TIME > 0;
    
UPDATE PRICE_TIMELINE SET PRICE = 25 WHERE URL = '/6323-buy-key-steam-deep-rock-galactic' AND TIME = '2020-04-15 13:11:00';

INSERT INTO REVIEW (ID_USER, ID_GAME, RATING) VALUES
		(1,4,10) ON DUPLICATE KEY UPDATE
		RATING = 1;
        
        
        
        
        
SELECT
			IFNULL(AVG(RE.RATING),-1) AS AVERAGE_RATING, 
            IFNULL(SUB.USER_RATING, -1),
			GA.ID AS ID_GAME, GA.NAME AS NAME,
		    GROUP_CONCAT(DISTINCT GE.NAME SEPARATOR ', ') AS GENRES
		FROM
			REVIEW RE RIGHT JOIN GAME GA ON RE.ID_GAME = GA.ID,
			(SELECT
					GA2.ID AS IDG, RE2.RATING AS USER_RATING
				FROM
					GAME GA2 LEFT JOIN REVIEW RE2 ON GA2.ID = RE2.ID_GAME AND RE2.ID_USER = 1
				ORDER BY
					GA2.ID
			) SUB, GENRE GE, GAME_GENRE GG
		WHERE
			IDG = GA.ID AND
		    GE.ID = GG.ID_GENRE AND
		    GA.ID = GG.ID_GAME
		GROUP BY
			GA.NAME, GA.ID, IDG
		ORDER BY 
			GA.ID;
  
SELECT
	IFNULL(AVG(RE.RATING),-1) AS AVERAGE_RATING, 
	GA.ID AS ID_GAME, GA.NAME AS NAME,
	GROUP_CONCAT(DISTINCT GE.NAME SEPARATOR ', ') AS GENRES
FROM
	GAME GA LEFT JOIN REVIEW RE ON GA.ID = RE.ID_GAME
    LEFT JOIN GAME_GENRE GG ON GA.ID = GG.ID_GAME
    LEFT JOIN GENRE GE ON GE.ID = GG.ID_GENRE
    RIGHT JOIN USER US ON US.ID = RE.ID_USER
WHERE
    US.ID = 1
GROUP BY
	GA.ID, GA.NAME;
    
  SELECT * FROM REVIEW;
  
        
        
        
        
        
        
        
        
        
        
        
        
        
        