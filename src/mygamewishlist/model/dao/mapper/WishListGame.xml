<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
  'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>
  
<mapper namespace="mygamewishlist.model.dao.mapper.WishListGameMapper">
	
	<select id="getListByIdUser" resultMap="resultList">
		SELECT
			SH.URL AS STORE_URL, WG.URL AS GAME_URL, ID_LIST, ID_STORE, 
			WG.NAME, WG.IMG, DEFAULT_PRICE, CURRENT_PRICE, 
			(100 - (CURRENT_PRICE * 100 / DEFAULT_PRICE)) AS DISCOUNT,
			LAST_NOTIFIED_PRICE, MIN_PRICE, MAX_PRICE
		FROM
			WISHLIST_GAME WG, LIST LI, STORE SH
		WHERE
			LI.ID = WG.ID_LIST AND
			SH.ID = WG.ID_STORE AND
			LI.ID_USER = #{idUser}
	</select>
	
	<select id="getGameFromListById" resultMap="resultList">
		SELECT
			SH.URL AS STORE_URL, WG.URL AS GAME_URL, ID_LIST, ID_STORE, 
			WG.NAME, WG.IMG, DEFAULT_PRICE, CURRENT_PRICE, 
			(100 - (CURRENT_PRICE * 100 / DEFAULT_PRICE)) AS DISCOUNT,
			LAST_NOTIFIED_PRICE, MIN_PRICE, MAX_PRICE
		FROM
			WISHLIST_GAME WG, LIST LI, STORE SH
		WHERE
			LI.ID = WG.ID_LIST AND
			SH.ID = WG.ID_STORE AND
			LI.ID_USER = #{idUser} AND
		    WG.URL = #{url}
	</select>
	
	<resultMap type="WishListGame" id="resultList">
		<id property="urlGame" column="GAME_URL" />
		<id property="idList" column="ID_LIST" />
		<result property="urlStore" column="STORE_URL" />
		<result property="idShop" column="ID_SHOP" />
		<result property="name" column="NAME" />
		<result property="img" column="IMG" />
		<result property="defaultPrice" column="DEFAULT_PRICE" />
		<result property="currentPrice" column="CURRENT_PRICE" />
		<result property="discount" column="DISCOUNT" />
		<result property="lastNotifiedPrice" column="LAST_NOTIFIED_PRICE" />
		<result property="minPrice" column="MIN_PRICE" />
		<result property="maxPrice" column="MAX_PRICE" />
	</resultMap>
</mapper>